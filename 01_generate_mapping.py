import pandas as pd

OUTPUT = 'location_map.csv'
m = []

# 1. 서울특별시 (25개 구 전수)
seoul = {
    '서울특별시서부교육지원청': ['마포구', '은평구', '서대문구'], '서울특별시동부교육지원청': ['동대문구', '중랑구'],
    '서울특별시남부교육지원청': ['영등포구', '구로구', '금천구'], '서울특별시북부교육지원청': ['도봉구', '노원구'],
    '서울특별시중부교육지원청': ['종로구', '중구', '용산구'], '서울특별시강동송파교육지원청': ['강동구', '송파구'],
    '서울특별시강서양천교육지원청': ['강서구', '양천구'], '서울특별시강남서초교육지원청': ['강남구', '서초구'],
    '서울특별시동작관악교육지원청': ['동작구', '관악구'], '서울특별시성동광진교육지원청': ['성동구', '광진구'],
    '서울특별시성북강북교육지원청': ['성북구', '강북구']
}
for h, ds in seoul.items():
    for d in ds: m.append({'Search_Key': f'서울{d}', 'Hub': h})

# 2. 광역시 (인천, 부산, 대구, 광주, 대전, 울산, 세종 전수)
# 규칙: 시도명 + 지명 (군은 유지하되 검색키는 지명만)
metros = {
    '인천': {'인천광역시남부교육지원청': ['중구', '미추홀구', '동구', '옹진군'], '인천광역시강화교육지원청': ['강화군'], '인천광역시동부교육지원청': ['연수구', '남동구'], '인천광역시북부교육지원청': ['부평구'], '인천광역시서부교육지원청': ['계양구', '서구']},
    '부산': {'부산광역시서부교육지원청': ['서구', '사하구', '영도구', '중구'], '부산광역시남부교육지원청': ['남구', '동구', '부산진구'], '부산광역시북부교육지원청': ['북구', '사상구', '강서구'], '부산광역시동래교육지원청': ['동래구', '금정구', '연제구'], '부산광역시해운대교육지원청': ['해운대구', '수영구', '기장군']},
    '대구': {'대구광역시동부교육지원청': ['중구', '동구', '수성구'], '대구광역시서부교육지원청': ['서구', '북구'], '대구광역시남부교육지원청': ['남구', '달서구'], '대구광역시달성교육지원청': ['달성군'], '대구광역시군위교육지원청': ['군위군']},
    '광주': {'광주광역시동부교육지원청': ['동구', '북구', '남구'], '광주광역시서부교육지원청': ['서구', '광산구']},
    '대전': {'대전광역시동부교육지원청': ['중구', '동구', '대덕구'], '대전광역시서부교육지원청': ['서구', '유성구']},
    '울산': {'울산광역시강남교육지원청': ['남구', '울주군'], '울산광역시강북교육지원청': ['중구', '동구', '북구']},
    '세종': {'세종특별자치시교육청': ['세종']}
}
for sido, hubs in metros.items():
    for h, ds in hubs.items():
        for d in ds:
            name = d.replace('군', '').replace('구', '')
            m.append({'Search_Key': f"{sido}{name}", 'Hub': h})

# 3. 도 단위 (9개 도 전수 / 시·군 명칭 제거 규칙)
provinces = {
    '경기': ['수원', '성남', '의정부', '안양', '부천', '광명', '평택', '동두천', '안산', '고양', '과천', '구리', '남양주', '오산', '시흥', '군포', '의왕', '하남', '용인', '파주', '이천', '안성', '김포', '화성', '광주', '양주', '포천', '여주', '연천', '가평', '양평'],
    '강원': ['춘천', '원주', '강릉', '속초', '양양', '동해', '태백', '삼척', '홍천', '횡성', '영월', '평창', '정선', '철원', '화천', '양구', '인제', '고성'],
    '충북': ['청주', '충주', '제천', '보은', '옥천', '영동', '진천', '괴산', '증평', '음성', '단양'],
    '충남': ['천안', '공주', '보령', '아산', '서산', '논산', '계룡', '당진', '금산', '부여', '서천', '청양', '홍성', '예산', '태안'],
    '전북': ['전주', '군산', '익산', '정읍', '남원', '김제', '완주', '진안', '무주', '장수', '임실', '순창', '고창', '부안'],
    '전남': ['목포', '여수', '순천', '나주', '광양', '담양', '곡성', '구례', '고흥', '보성', '화순', '장흥', '강진', '해남', '영암', '무안', '함평', '영광', '장성', '완도', '진도', '신안'],
    '경북': ['포항', '경주', '김천', '안동', '구미', '영주', '영천', '상주', '문경', '경산', '의성', '청송', '영양', '영덕', '청도', '고령', '성주', '칠곡', '예천', '봉화', '울진', '울릉'],
    '경남': ['창원', '진주', '통영', '사천', '김해', '밀양', '거제', '양산', '의령', '함안', '창녕', '고성', '남해', '하동', '산청', '함양', '거창', '합천'],
    '제주': ['제주', '서귀포']
}

for sido, cities in provinces.items():
    for city in cities:
        # 정식 지원청 명칭 매핑
        if sido == '전남': h = "전라남도목포교육지원청" if city == '신안' else f"전라남도{city}교육지원청"
        elif sido == '경기':
            if city in ['안양', '과천']: h = "경기도안양과천교육지원청"
            elif city in ['군포', '의왕']: h = "경기도군포의왕교육지원청"
            elif city in ['화성', '오산']: h = "경기도화성오산교육지원청"
            elif city in ['광주', '하남']: h = "경기도광주하남교육지원청"
            elif city in ['구리', '남양주']: h = "경기도구리남양주교육지원청"
            elif city in ['동두천', '양주']: h = "경기도동두천양주교육지원청"
            else: h = f"경기도{city}교육지원청"
        elif sido in ['전북', '강원', '제주']: h = f"{sido}특별자치도{city}교육지원청"
        else: h = f"{sido}도{city}교육지원청"
        m.append({'Search_Key': f"{sido}{city}", 'Hub': h})

pd.DataFrame(m).to_csv(OUTPUT, index=False, encoding='utf-8-sig')
print(f"총 {len(m)}개 지역 매핑 완료. (229개 전후 확인 요망)")