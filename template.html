<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>yeobi-easy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script>
        window.tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'pulse-spread': 'pulse-spread 2s infinite',
                        'slide-up': 'slideUpModal 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'twinkle-text': 'twinkle 1.5s infinite ease-in-out',
                    },
                    keyframes: {
                        'pulse-spread': { '0%': { boxShadow: '0 0 0 0 rgba(0, 191, 165, 0.7)' }, '70%': { boxShadow: '0 0 0 10px rgba(0, 191, 165, 0)' }, '100%': { boxShadow: '0 0 0 0 rgba(0, 191, 165, 0)' } },
                        'slideUpModal': { 'from': { transform: 'translateY(20px)', opacity: '0' }, 'to': { transform: 'translateY(0)', opacity: '1' } },
                        'twinkle': { '0%, 100%': { opacity: '1', textShadow: '0 0 2px rgba(255,255,255,0.2)' }, '50%': { opacity: '0.6', textShadow: '0 0 8px rgba(255,255,255,0.9)' } }
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        @import url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2001@1.1/GmarketSansMedium.css');
        
        :root {
            --font-gmarket: 'GmarketSansMedium', sans-serif;
            --font-pretendard: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            --color-teal: #00BFA5;
            --color-bg-base: #E5E8EB;
            --color-text-main: #191F28;
            --color-btn-main: #00BFA5;
        }

        html { scrollbar-gutter: stable; }
        body { 
            font-family: var(--font-pretendard); background-color: var(--color-bg-base); color: var(--color-text-main); margin: 0;
            display: flex; justify-content: center; min-height: 100vh; overflow-y: scroll; overflow-x: hidden; -webkit-font-smoothing: antialiased;
        }

        .main-wrapper { 
            width: 100%; max-width: 480px; min-height: 100vh; display: flex; flex-direction: column; background-color: #FFFFFF; position: relative; box-shadow: 0 0 30px rgba(0,0,0,0.08);
        }

        @media (min-width: 768px) {
            body { align-items: center; padding: 24px 0; box-sizing: border-box; overflow-y: auto; }
            .main-wrapper { min-height: unset; height: auto; max-height: calc(100vh - 48px); overflow-y: auto; overflow-x: hidden; border-radius: 32px; box-shadow: 0 8px 60px rgba(0,0,0,0.18), 0 0 0 1px rgba(0,0,0,0.04); }
        }

        .input-group { 
            background-color: #F8FAFC; border-radius: 18px; padding: 0 20px; display: flex; align-items: center; gap: 16px; width: 100%; box-sizing: border-box; height: 76px; border: 2px solid #E6B0AA; font-family: var(--font-gmarket); 
        }
        .input-group:focus-within { border-color: #D48888; background-color: #FFFFFF; box-shadow: 0 0 0 2px rgba(230, 176, 170, 0.3); }

        .tag-badge {
            display: inline-flex; align-items: center; justify-content: center;
            border-radius: 6px; font-weight: 800;
            margin: 0 2px; font-family: var(--font-gmarket); 
            box-shadow: 0 1px 2px rgba(0,0,0,0.05); border: 1px solid transparent;
        }

        .tag-side {
            display: inline-flex; align-items: center; justify-content: center;
            padding: 1px 4px; border-radius: 3px; font-size: 9px; font-weight: 700;
            margin-left: 2px; white-space: nowrap; font-family: var(--font-pretendard); border: 1px solid transparent;
            position: relative; top: -6px;
        }

        .header-teal { background: white; border-bottom: 1px solid #F1F5F9; padding: 12px 20px; display: flex; align-items: center; justify-content: space-between; width: 100%; position: relative; z-index: 40; }
        .mode-switch-container { display: flex; align-items: center; justify-content: center; background-color: #E2E8F0; border-radius: 99px; width: 110px; height: 38px; position: relative; cursor: pointer; padding: 3px; user-select: none; }
        .mode-switch-slider { position: absolute; top: 3px; bottom: 3px; width: calc(50% - 3px); background-color: #FFFFFF; border-radius: 99px; transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 2px 5px rgba(0,0,0,0.15); }
        .mode-switch-slider.extra { left: 3px; }
        .mode-switch-slider.intra { left: calc(50%); }
        .mode-text { flex: 1; z-index: 10; text-align: center; font-size: 12px; font-weight: 800; transition: color 0.2s; }
        .mode-text.active { color: var(--color-teal); }
        .mode-text.inactive { color: #64748B; }

        .deduct-btn {
            position: absolute; left: 50%; top: 50%; 
            transform: translate(-50%, -50%); 
            font-size: 13px; padding: 6px 14px; border-radius: 8px; font-weight: 800;
            cursor: pointer; z-index: 10; font-family: var(--font-gmarket); 
            transition: all 0.1s ease;
            background-color: #0EA5E9; /* Sky-500 */
            color: #FFFFFF;
            border: none;
            box-shadow: 0 4px 0 #0284C7; /* Sky-700 */
        }

        .deduct-btn.active { 
            background-color: #F1F5F9; /* Slate-100 */
            color: #94A3B8; /* Slate-400 */
            border: none;
            box-shadow: inset 0 2px 4px 0 rgba(0,0,0,0.06); 
            transform: translate(-50%, calc(-50% + 4px)); 
            animation: none;
        }

        .detail-drawer { max-height: 0; overflow: hidden; transition: max-height 1s cubic-bezier(0.25, 1, 0.5, 1); background-color: #ffffff; border-radius: 0 0 16px 16px; }
        .detail-drawer.open { max-height: 2000px; }
        
        input.ship-fare-input { 
            text-align: right; 
            background-color: #FFFFFF; 
            width: 84px; 
            font-family: var(--font-gmarket); 
            font-weight: 700; 
            outline: none; 
            border: 1px solid #E2E8F0; 
            border-radius: 6px;
            padding: 6px 8px; 
            margin: 0; 
            color: #94A3B8; 
            font-size: 16px; 
            transition: all 0.2s;
        }
        
        input.ship-fare-input:focus { 
            border-color: #CBD5E1; 
            color: #64748B; 
            box-shadow: none; 
        }

        input.ship-fare-input::selection {
            background-color: #F1F5F9; 
            color: #475569; 
        }

        .suggestions-box { position: absolute; left: 0; right: 0; top: 100%; margin-top: 4px; background: white; border: 1px solid #E2E8F0; border-radius: 12px; z-index: 999; box-shadow: 0 10px 30px -5px rgba(0, 0, 0, 0.15); max-height: 240px; overflow-y: auto; font-family: var(--font-gmarket); }
        .suggestion-item { padding: 12px 16px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-size: 14px; color: #374151; font-weight: 500; }
        .suggestion-item:hover, .suggestion-item.active { background-color: #E0F2F1; }

        @keyframes bounce-custom {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20%); } 
        }
        .icon-bounce { display: inline-block; animation: bounce-custom 2s infinite; margin-left: 4px; }
        
        .toggle-switch { width: 40px; height: 22px; border-radius: 99px; transition: 0.2s; position: relative; }
        .toggle-knob { width: 18px; height: 18px; background: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: 0.2s; box-shadow: 0 1px 2px rgba(0,0,0,0.2); }
        .toggle-active { background: var(--color-teal); }
        .toggle-inactive { background: #CBD5E1; }
        .knob-active { transform: translateX(18px); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const Icons = {
            MapPin: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>,
            Search: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" {...props}><circle cx="11" cy="11" r="8"/><path d="m21 21-4.3-4.3"/></svg>,
            ChevronDown: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="m6 9 6 6 6-6"/></svg>,
            X: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            Send: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><line x1="22" x2="11" y1="2" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>,
            Calculator: (props) => <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M8 18h.01"/><path d="M12 18h.01"/></svg>
        };

        const REGION_ICONS = {
            "ê´‘ì£¼": "ğŸ‰", "ëª©í¬": "âš“", "ì—¬ìˆ˜": "ğŸŒ´", "ìˆœì²œ": "ğŸŒ¾", "ë‚˜ì£¼": "ğŸ", "ê´‘ì–‘": "âš½",
            "ë‹´ì–‘": "ğŸ‹", "ê³¡ì„±": "ğŸš‚", "êµ¬ë¡€": "ğŸ»", "ê³ í¥": "ğŸš€", "ë³´ì„±": "ğŸµ", "í™”ìˆœ": "ğŸ—¿", "ì¥í¥": "ğŸ„",
            "ê°•ì§„": "ğŸº", "í•´ë‚¨": "ğŸ¦•", "ì˜ì•”": "ğŸï¸", "ë¬´ì•ˆ": "ğŸ§…", "í•¨í‰": "ğŸ¦‹", "ì˜ê´‘": "ğŸŸ", "ì¥ì„±": "ğŸ‚", "ì™„ë„": "ğŸ¦ª", "ì§„ë„": "ğŸ•",
            "ì‹ ì•ˆ": "ğŸª½", "ì‹ ì•ˆêµìœ¡ì²­": "âš“ï¸", "ë‚¨ì•…": "ğŸ›ï¸", "ì§€ë„": "ğŸ§‚", "ì••í•´": "ğŸ™", "ì¦ë„": "ğŸš²", "ì„ì": "ğŸŒ·",
            "ìì€": "ğŸ–ï¸", "ì•ˆì¢Œ": "ğŸ™‹â€â™€ï¸", "íŒ”ê¸ˆ": "ğŸ¦", "ì•”íƒœ": "ğŸŒ", "ë¹„ê¸ˆ": "ğŸ¦…", "ë„ì´ˆ": "ğŸŒ¿", "í‘ì‚°": "ğŸŸ", "í•˜ì˜": "ğŸ•Šï¸", "ì‹ ì˜": "ğŸ§‚", "ì¥ì‚°": "ğŸ”ï¸",
            "ì²­ì‚°": "ğŸŒ", "ë…¸í™”": "ğŸ¦ª", "ì†Œì•ˆ": "ğŸŒº", "ì—¬ì„œë„": "ğŸ£", "ê¸ˆì¼": "ğŸŒŠ", "ìƒì¼": "ğŸ‚", "ë³´ê¸¸": "ğŸ“œ", 
            "ê¸ˆë‹¹": "ğŸ—¿", "êµ°ì™¸": "ğŸŒ…", "ì‹ ì§€": "ğŸ–ï¸", "ê³ ê¸ˆ": "ğŸš¢", "ì•½ì‚°": "ğŸ", "í™ë„": "ğŸŒ…", "ê°€ê±°ë„": "ğŸï¸", "ë§Œì¬ë„": "ğŸ£", 
            "ì§„ë„ì¡°ë„": "ğŸ¦…", "ì§„ë„ì„œê±°ì°¨ë„": "ğŸš¢", "ì§„ë„ê´€ë§¤ë„": "ğŸŒ²", "ê³ í¥ë“ëŸ‰ë„": "ğŸŒ¾", "ê³ í¥ì‘¥ì„¬(ì• ë„)": "ğŸˆ",
            "ì˜ê´‘ì•ˆë§ˆë„": "ğŸ", "ì˜ê´‘ë‚™ì›”": "ğŸŒ™", "ì˜ê´‘ì†¡ì´ë„": "ğŸš", "í•´ë‚¨ì–´ë£¡ë„": "ğŸ‰"
        };

        const POPUP_REGIONS = {
            "ì‹ ì•ˆ": ["ì‹ ì•ˆêµìœ¡ì²­", "ì§€ë„", "ì••í•´", "ì¦ë„", "ì„ì", "ìì€", "ì•ˆì¢Œ", "íŒ”ê¸ˆ", "ì•”íƒœ", "ë¹„ê¸ˆ", "ë„ì´ˆ", "í‘ì‚°", "í•˜ì˜", "ì‹ ì˜", "ì¥ì‚°", "í™ë„", "ê°€ê±°ë„", "ë§Œì¬ë„"],
            "ì™„ë„": ["ì™„ë„", "ê¸ˆì¼", "ë…¸í™”", "êµ°ì™¸", "ì‹ ì§€", "ê³ ê¸ˆ", "ì•½ì‚°", "ì²­ì‚°", "ì†Œì•ˆ", "ê¸ˆë‹¹", "ë³´ê¸¸", "ìƒì¼", "ì—¬ì„œë„"]
        };

        const ISLAND_DB = {
            "ì‹ ì•ˆ": { hub: "ëª©í¬", cost: 0, type: "connected" }, "ì‹ ì•ˆêµìœ¡ì²­": { hub: "ëª©í¬", cost: 0, type: "connected" }, "ì••í•´": { hub: "ëª©í¬", via: "ëª©í¬", cost: 2000, type: "connected" }, "ì§€ë„": { hub: "ëª©í¬", via: "ëª©í¬", cost: 2000, type: "connected" }, "ì¦ë„": { hub: "ëª©í¬", via: "ëª©í¬", cost: 2000, type: "connected" }, "ì„ì": { hub: "ëª©í¬", via: "ëª©í¬", cost: 2000, type: "connected" }, "íŒ”ê¸ˆ": { hub: "ëª©í¬", via: "ëª©í¬", cost: 2000, type: "connected" }, "ì•”íƒœ": { hub: "ëª©í¬", via: "ëª©í¬", cost: 2000, type: "connected" }, "ìì€": { hub: "ëª©í¬", via: "ëª©í¬", cost: 2000, type: "connected" }, "ì•ˆì¢Œ": { hub: "ëª©í¬", via: "ëª©í¬", cost: 2000, type: "connected" }, 
            "ë¹„ê¸ˆ": { hub: "ëª©í¬", via: "ëª©í¬, ì•”íƒœ", cost: 2000, shipCost: 1000, type: "ship", special: true }, 
            "ë„ì´ˆ": { hub: "ëª©í¬", via: "ëª©í¬", cost: 0, shipCost: 1000, type: "ship", special: true }, 
            "ì¥ì‚°": { hub: "ëª©í¬", cost: 0, shipCost: 1000, type: "ship" }, "í•˜ì˜": { hub: "ëª©í¬", cost: 0, shipCost: 1000, type: "ship" }, "ì‹ ì˜": { hub: "ëª©í¬", cost: 0, shipCost: 1000, type: "ship" }, "í‘ì‚°": { hub: "ëª©í¬", cost: 0, shipCost: 1000, type: "ship" }, "í™ë„": { hub: "ëª©í¬", cost: 0, shipCost: 1000, type: "ship" }, "ê°€ê±°ë„": { hub: "ëª©í¬", cost: 0, shipCost: 1000, type: "ship" }, "ë§Œì¬ë„": { hub: "ëª©í¬", cost: 0, shipCost: 1000, type: "ship" }, "ì™„ë„": { hub: "ì™„ë„", cost: 0, type: "connected", special: true }, "êµ°ì™¸": { hub: "ì™„ë„", cost: 0, type: "connected", special: true }, "ì‹ ì§€": { hub: "ì™„ë„", cost: 0, type: "connected", special: true }, "ê³ ê¸ˆ": { hub: "ì™„ë„", cost: 0, type: "connected", special: true }, "ì•½ì‚°": { hub: "ì™„ë„", cost: 0, type: "connected", special: true }, "ì²­ì‚°": { hub: "ì™„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ë…¸í™”": { hub: "ì™„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ë³´ê¸¸": { hub: "ì™„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ì†Œì•ˆ": { hub: "ì™„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ì—¬ì„œë„": { hub: "ì™„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ê¸ˆì¼": { hub: "ì™„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ìƒì¼": { hub: "ì™„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ì§„ë„ì¡°ë„": { hub: "ì§„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ì§„ë„ê´€ë§¤ë„": { hub: "ì§„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ì§„ë„ì„œê±°ì°¨ë„": { hub: "ì§„ë„", cost: 0, shipCost: 1000, type: "ship" }, "ê³ í¥ë“ëŸ‰ë„": { hub: "ê³ í¥", cost: 0, shipCost: 1000, type: "ship" }, "ê³ í¥ì‘¥ì„¬(ì• ë„)": { hub: "ê³ í¥", cost: 0, shipCost: 1000, type: "ship" }, "ì˜ê´‘ì•ˆë§ˆë„": { hub: "ì˜ê´‘", cost: 0, shipCost: 1000, type: "ship" }, "ì˜ê´‘ë‚™ì›”": { hub: "ì˜ê´‘", cost: 0, shipCost: 1000, type: "ship" }, "ì˜ê´‘ì†¡ì´ë„": { hub: "ì˜ê´‘", cost: 0, shipCost: 1000, type: "ship" }, "ê¸ˆë‹¹": { hub: "ì¥í¥", cost: 0, shipCost: 1000, type: "ship" }, "í•´ë‚¨ì–´ë£¡ë„": { hub: "í•´ë‚¨", cost: 0, shipCost: 1000, type: "ship" }
        };

        const SAME_AREA_GROUPS = [
            new Set(["ëª©í¬", "ì‹ ì•ˆ", "ì‹ ì•ˆêµìœ¡ì²­"]), new Set(["ë…¸í™”", "ë³´ê¸¸"]), new Set(["ë¹„ê¸ˆ", "ë„ì´ˆ"]),
            new Set(["ì••í•´", "ìì€", "íŒ”ê¸ˆ", "ì•”íƒœ", "ì•ˆì¢Œ", "ì„ì", "ì§€ë„", "ì¦ë„"]),
            new Set(["êµ°ì™¸", "ì™„ë„", "ê³ ê¸ˆ", "ì•½ì‚°", "ì‹ ì§€", "ê¸ˆë‹¹"])
        ];

        const INITIAL_DATA = {
            "ê´‘ì£¼": { "ëª©í¬": { gen: 7200, pre: 9300 }, "ì—¬ìˆ˜": { gen: 13000, pre: 16800 }, "ìˆœì²œ": { gen: 8400, pre: 11000 }, "ë‚˜ì£¼": { gen: 4300 }, "ê´‘ì–‘": { gen: 8400, pre: 10900 }, "ë‹´ì–‘": { gen: 2900 }, "ê³¡ì„±": { gen: 5500 }, "êµ¬ë¡€": { gen: 9800 }, "ê³ í¥": { gen: 16200, pre: 21000 }, "ë³´ì„±": { gen: 10500, pre: 11500 }, "í™”ìˆœ": { gen: 2500 }, "ì¥í¥": { gen: 11500, pre: 14900 }, "ê°•ì§„": { gen: 11700, pre: 15200 }, "í•´ë‚¨": { gen: 13700, pre: 16900 }, "ì˜ì•”": { gen: 8700 }, "ë¬´ì•ˆ": { gen: 6000, pre: 7800 }, "í•¨í‰": { gen: 4500, pre: 5800 }, "ì˜ê´‘": { gen: 7300, pre: 9500 }, "ì¥ì„±": { gen: 2400 }, "ì™„ë„": { gen: 20500, pre: 24800 }, "ì§„ë„": { gen: 15300, pre: 19900 }, "ë‚¨ì•…": { gen: 7200, pre: 9300 } },
            "ëª©í¬": { "ê´‘ì£¼": { gen: 7200, pre: 9300 }, "ì—¬ìˆ˜": { gen: 16500, pre: 21400 }, "ìˆœì²œ": { gen: 11500, pre: 15000 }, "ë‚˜ì£¼": { gen: 7300 }, "ê´‘ì–‘": { gen: 13700, pre: 17800 }, "ë‹´ì–‘": { gen: 10100 }, "ê³¡ì„±": { gen: 12700 }, "êµ¬ë¡€": { gen: 17000 }, "ê³ í¥": { gen: 18600 }, "ë³´ì„±": { gen: 13500 }, "í™”ìˆœ": { gen: 9700 }, "ì¥í¥": { gen: 10200 }, "ê°•ì§„": { gen: 7800 }, "í•´ë‚¨": { gen: 8700 }, "ì˜ì•”": { gen: 6400 }, "ë¬´ì•ˆ": { gen: 3200 }, "í•¨í‰": { gen: 5100 }, "ì˜ê´‘": { gen: 8700 }, "ì¥ì„±": { gen: 9600 }, "ì™„ë„": { gen: 15700 }, "ì§„ë„": { gen: 8300, pre: 10800 }, "ë‚¨ì•…": { gen: 1700 } },
            "ì—¬ìˆ˜": { "ê´‘ì£¼": { gen: 13000, pre: 16800 }, "ëª©í¬": { gen: 16500, pre: 21400 }, "ìˆœì²œ": { gen: 5000 }, "ë‚˜ì£¼": { gen: 17300 }, "ê´‘ì–‘": { gen: 7500 }, "ë‹´ì–‘": { gen: 15900 }, "ê³¡ì„±": { gen: 18500 }, "êµ¬ë¡€": { gen: 10200 }, "ê³ í¥": { gen: 13600 }, "ë³´ì„±": { gen: 12800 }, "í™”ìˆœ": { gen: 15500 }, "ì¥í¥": { gen: 16100 }, "ê°•ì§„": { gen: 18500 }, "í•´ë‚¨": { gen: 21500 }, "ì˜ì•”": { gen: 22400 }, "ë¬´ì•ˆ": { gen: 19000 }, "í•¨í‰": { gen: 17500 }, "ì˜ê´‘": { gen: 20300 }, "ì¥ì„±": { gen: 15400 }, "ì™„ë„": { gen: 28200 }, "ì§„ë„": { gen: 24800 }, "ë‚¨ì•…": { gen: 15600, pre: 20200 } },
            "ìˆœì²œ": { "ê´‘ì£¼": { gen: 8400, pre: 11000 }, "ëª©í¬": { gen: 11500, pre: 15000 }, "ì—¬ìˆ˜": { gen: 5000 }, "ë‚˜ì£¼": { gen: 12700 }, "ê´‘ì–‘": { gen: 2500 }, "ë‹´ì–‘": { gen: 10100 }, "ê³¡ì„±": { gen: 9400 }, "êµ¬ë¡€": { gen: 5200 }, "ê³ í¥": { gen: 8700 }, "ë³´ì„±": { gen: 7900 }, "í™”ìˆœ": { gen: 9700 }, "ì¥í¥": { gen: 11100 }, "ê°•ì§„": { gen: 13500 }, "í•´ë‚¨": { gen: 16600 }, "ì˜ì•”": { gen: 17500 }, "ë¬´ì•ˆ": { gen: 14700, pre: 18200 }, "í•¨í‰": { gen: 12900 }, "ì˜ê´‘": { gen: 15700 }, "ì¥ì„±": { gen: 10800 }, "ì™„ë„": { gen: 23200 }, "ì§„ë„": { gen: 23900 }, "ë‚¨ì•…": { gen: 10600, pre: 13800 } },
            "ë‚˜ì£¼": { "ê´‘ì£¼": { gen: 4300 }, "ëª©í¬": { gen: 7300 }, "ì—¬ìˆ˜": { gen: 17300 }, "ìˆœì²œ": { gen: 12700 }, "ê´‘ì–‘": { gen: 12700 }, "ë‹´ì–‘": { gen: 7200 }, "ê³¡ì„±": { gen: 9800 }, "êµ¬ë¡€": { gen: 14100 }, "ê³ í¥": { gen: 20500 }, "ë³´ì„±": { gen: 14800 }, "í™”ìˆœ": { gen: 6800 }, "ì¥í¥": { gen: 9000 }, "ê°•ì§„": { gen: 8200 }, "í•´ë‚¨": { gen: 9900 }, "ì˜ì•”": { gen: 4400 }, "ë¬´ì•ˆ": { gen: 4100 }, "í•¨í‰": { gen: 3700 }, "ì˜ê´‘": { gen: 7400 }, "ì¥ì„±": { gen: 6700 }, "ì™„ë„": { gen: 16600 }, "ì§„ë„": { gen: 17200 }, "ë‚¨ì•…": { gen: 9000 } },
            "ê´‘ì–‘": { "ê´‘ì£¼": { gen: 8400, pre: 10900 }, "ëª©í¬": { gen: 13700, pre: 17800 }, "ì—¬ìˆ˜": { gen: 7500 }, "ìˆœì²œ": { gen: 2500 }, "ë‚˜ì£¼": { gen: 12700 }, "ë‹´ì–‘": { gen: 11300 }, "ê³¡ì„±": { gen: 13900 }, "êµ¬ë¡€": { gen: 7700 }, "ê³ í¥": { gen: 8700 }, "ë³´ì„±": { gen: 9900 }, "í™”ìˆœ": { gen: 10900 }, "ì¥í¥": { gen: 13200 }, "ê°•ì§„": { gen: 15600 }, "í•´ë‚¨": { gen: 19100 }, "ì˜ì•”": { gen: 19500 }, "ë¬´ì•ˆ": { gen: 14400 }, "í•¨í‰": { gen: 12900 }, "ì˜ê´‘": { gen: 15700 }, "ì¥ì„±": { gen: 10800 }, "ì™„ë„": { gen: 25800 }, "ì§„ë„": { gen: 23400 }, "ë‚¨ì•…": { gen: 11700 } },
            "ë‹´ì–‘": { "ê´‘ì£¼": { gen: 2900 }, "ëª©í¬": { gen: 10100 }, "ì—¬ìˆ˜": { gen: 15900 }, "ìˆœì²œ": { gen: 10100 }, "ë‚˜ì£¼": { gen: 11300 }, "ê´‘ì–‘": { gen: 11300 }, "ê³¡ì„±": { gen: 8400 }, "êµ¬ë¡€": { gen: 12700 }, "ê³ í¥": { gen: 19100 }, "ë³´ì„±": { gen: 13400 }, "í™”ìˆœ": { gen: 8000 }, "ì¥í¥": { gen: 14400 }, "ê°•ì§„": { gen: 14600 }, "í•´ë‚¨": { gen: 16600 }, "ì˜ì•”": { gen: 11600 }, "ë¬´ì•ˆ": { gen: 8900 }, "í•¨í‰": { gen: 7400 }, "ì˜ê´‘": { gen: 10200 }, "ì¥ì„±": { gen: 5300 }, "ì™„ë„": { gen: 23400 }, "ì§„ë„": { gen: 18200 }, "ë‚¨ì•…": { gen: 10100 } },
            "ê³¡ì„±": { "ê´‘ì£¼": { gen: 5500 }, "ëª©í¬": { gen: 12700 }, "ì—¬ìˆ˜": { gen: 18500 }, "ìˆœì²œ": { gen: 9800 }, "ë‚˜ì£¼": { gen: 9800 }, "ê´‘ì–‘": { gen: 13900 }, "ë‹´ì–‘": { gen: 8400 }, "êµ¬ë¡€": { gen: 4300 }, "ê³ í¥": { gen: 21400 }, "ë³´ì„±": { gen: 17300 }, "í™”ìˆœ": { gen: 8000 }, "ì¥í¥": { gen: 17000 }, "ê°•ì§„": { gen: 2400 }, "í•´ë‚¨": { gen: 19200 }, "ì˜ì•”": { gen: 14200 }, "ë¬´ì•ˆ": { gen: 11500 }, "í•¨í‰": { gen: 8800 }, "ì˜ê´‘": { gen: 12800 }, "ì¥ì„±": { gen: 7900 }, "ì™„ë„": { gen: 23000 }, "ì§„ë„": { gen: 20800 }, "ë‚¨ì•…": { gen: 12700 } },
            "êµ¬ë¡€": { "ê´‘ì£¼": { gen: 9800 }, "ëª©í¬": { gen: 17000 }, "ì—¬ìˆ˜": { gen: 10200 }, "ìˆœì²œ": { gen: 5200 }, "ë‚˜ì£¼": { gen: 14100 }, "ê´‘ì–‘": { gen: 7700 }, "ë‹´ì–‘": { gen: 12700 }, "ê³¡ì„±": { gen: 4300 }, "ê³ í¥": { gen: 13900 }, "ë³´ì„±": { gen: 13100 }, "í™”ìˆœ": { gen: 12300 }, "ì¥í¥": { gen: 16300 }, "ê°•ì§„": { gen: 11400 }, "í•´ë‚¨": { gen: 13700 }, "ì˜ì•”": { gen: 8700 }, "ë¬´ì•ˆ": { gen: 6000 }, "í•¨í‰": { gen: 4500 }, "ì˜ê´‘": { gen: 7300 }, "ì¥ì„±": { gen: 2400 }, "ì™„ë„": { gen: 20500 }, "ì§„ë„": { gen: 15300 }, "ë‚¨ì•…": { gen: 7200 } },
            "ê³ í¥": { "ê´‘ì£¼": { gen: 16200, pre: 21000 }, "ëª©í¬": { gen: 18600 }, "ì—¬ìˆ˜": { gen: 13600 }, "ìˆœì²œ": { gen: 8700 }, "ë‚˜ì£¼": { gen: 20500 }, "ê´‘ì–‘": { gen: 10200 }, "ë‹´ì–‘": { gen: 19100 }, "ê³¡ì„±": { gen: 21400 }, "êµ¬ë¡€": { gen: 13900 }, "ë³´ì„±": { gen: 9900 }, "í™”ìˆœ": { gen: 13700 }, "ì¥í¥": { gen: 13100 }, "ê°•ì§„": { gen: 14200 }, "í•´ë‚¨": { gen: 18600 }, "ì˜ì•”": { gen: 19500 }, "ë¬´ì•ˆ": { gen: 22200 }, "í•¨í‰": { gen: 20700 }, "ì˜ê´‘": { gen: 23500 }, "ì¥ì„±": { gen: 18600 }, "ì™„ë„": { gen: 25200 }, "ì§„ë„": { gen: 25900 }, "ë‚¨ì•…": { gen: 23400 } },
            "ë³´ì„±": { "ê´‘ì£¼": { gen: 10500, pre: 11500 }, "ëª©í¬": { gen: 13500 }, "ì—¬ìˆ˜": { gen: 12800 }, "ìˆœì²œ": { gen: 7900 }, "ë‚˜ì£¼": { gen: 14800 }, "ê´‘ì–‘": { gen: 9900 }, "ë‹´ì–‘": { gen: 13400 }, "ê³¡ì„±": { gen: 17300 }, "êµ¬ë¡€": { gen: 13100 }, "ê³ í¥": { gen: 9900 }, "í™”ìˆœ": { gen: 7800 }, "ì¥í¥": { gen: 3200 }, "ê°•ì§„": { gen: 5700 }, "í•´ë‚¨": { gen: 8700 }, "ì˜ì•”": { gen: 7800 }, "ë¬´ì•ˆ": { gen: 16700 }, "í•¨í‰": { gen: 15000 }, "ì˜ê´‘": { gen: 17800 }, "ì¥ì„±": { gen: 12900 }, "ì™„ë„": { gen: 15400 }, "ì§„ë„": { gen: 16000 }, "ë‚¨ì•…": { gen: 13500 } },
            "í™”ìˆœ": { "ê´‘ì£¼": { gen: 2500 }, "ëª©í¬": { gen: 9700 }, "ì—¬ìˆ˜": { gen: 15500 }, "ìˆœì²œ": { gen: 9700 }, "ë‚˜ì£¼": { gen: 6800 }, "ê´‘ì–‘": { gen: 8000 }, "ë‹´ì–‘": { gen: 8000 }, "ê³¡ì„±": { gen: 8000 }, "êµ¬ë¡€": { gen: 12300 }, "ê³ í¥": { gen: 13700 }, "ë³´ì„±": { gen: 7800 }, "ì¥í¥": { gen: 10000 }, "ê°•ì§„": { gen: 11400 }, "í•´ë‚¨": { gen: 16500 }, "ì˜ì•”": { gen: 11200 }, "ë¬´ì•ˆ": { gen: 8500 }, "í•¨í‰": { gen: 7000 }, "ì˜ê´‘": { gen: 9800 }, "ì¥ì„±": { gen: 4900 }, "ì™„ë„": { gen: 23000 }, "ì§„ë„": { gen: 17800 }, "ë‚¨ì•…": { gen: 9700 } },
            "ì¥í¥": { "ê´‘ì£¼": { gen: 11500, pre: 14900 }, "ëª©í¬": { gen: 10200 }, "ì—¬ìˆ˜": { gen: 16100 }, "ìˆœì²œ": { gen: 11100 }, "ë‚˜ì£¼": { gen: 9000 }, "ê´‘ì–‘": { gen: 13200 }, "ë‹´ì–‘": { gen: 14400 }, "ê³¡ì„±": { gen: 17000 }, "êµ¬ë¡€": { gen: 16300 }, "ê³ í¥": { gen: 13100 }, "ë³´ì„±": { gen: 3200 }, "í™”ìˆœ": { gen: 10000 }, "ê°•ì§„": { gen: 2400 }, "í•´ë‚¨": { gen: 5400 }, "ì˜ì•”": { gen: 4600 }, "ë¬´ì•ˆ": { gen: 8500 }, "í•¨í‰": { gen: 2500 }, "ì˜ê´‘": { gen: 5500 }, "ì¥ì„±": { gen: 8400 }, "ì™„ë„": { gen: 2300 }, "ì§„ë„": { gen: 12700 }, "ë‚¨ì•…": { gen: 9700 } },
            "ê°•ì§„": { "ê´‘ì£¼": { gen: 11700, pre: 15200 }, "ëª©í¬": { gen: 7800 }, "ì—¬ìˆ˜": { gen: 18500 }, "ìˆœì²œ": { gen: 13500 }, "ë‚˜ì£¼": { gen: 8200 }, "ê´‘ì–‘": { gen: 12700 }, "ë‹´ì–‘": { gen: 14600 }, "ê³¡ì„±": { gen: 17200 }, "êµ¬ë¡€": { gen: 11400 }, "í•´ë‚¨": { gen: 3000 }, "ì˜ì•”": { gen: 8700 }, "ë¬´ì•ˆ": { gen: 6000 }, "í•¨í‰": { gen: 4500 }, "ì˜ê´‘": { gen: 7300 }, "ì¥ì„±": { gen: 2400 }, "ì™„ë„": { gen: 20500 }, "ì§„ë„": { gen: 15300 }, "ë‚¨ì•…": { gen: 7200 } },
            "í•´ë‚¨": { "ê´‘ì£¼": { gen: 13700, pre: 16900 }, "ëª©í¬": { gen: 8700 }, "ì—¬ìˆ˜": { gen: 21500 }, "ìˆœì²œ": { gen: 16600 }, "ë‚˜ì£¼": { gen: 9900 }, "ê´‘ì–‘": { gen: 19100 }, "ë‹´ì–‘": { gen: 16600 }, "ê³¡ì„±": { gen: 19200 }, "êµ¬ë¡€": { gen: 21800 }, "ê³ í¥": { gen: 18600 }, "ë³´ì„±": { gen: 8700 }, "í™”ìˆœ": { gen: 16500 }, "ì¥í¥": { gen: 5400 }, "ê°•ì§„": { gen: 3000 }, "ì˜ì•”": { gen: 4900 }, "ë¬´ì•ˆ": { gen: 8500 }, "í•¨í‰": { gen: 7000 }, "ì˜ê´‘": { gen: 9800 }, "ì¥ì„±": { gen: 4900 }, "ì™„ë„": { gen: 6700, pre: 8200 }, "ì§„ë„": { gen: 7300 }, "ë‚¨ì•…": { gen: 8500 } },
            "ì˜ì•”": { "ê´‘ì£¼": { gen: 8700 }, "ëª©í¬": { gen: 6400 }, "ì—¬ìˆ˜": { gen: 22400 }, "ìˆœì²œ": { gen: 17500 }, "ë‚˜ì£¼": { gen: 4400 }, "ê´‘ì–‘": { gen: 19500 }, "ë‹´ì–‘": { gen: 11600 }, "ê³¡ì„±": { gen: 14200 }, "êµ¬ë¡€": { gen: 18500 }, "ê³ í¥": { gen: 19500 }, "ë³´ì„±": { gen: 7800 }, "í™”ìˆœ": { gen: 11200 }, "ì¥í¥": { gen: 4600 }, "ê°•ì§„": { gen: 3900 }, "í•´ë‚¨": { gen: 4900 }, "ë¬´ì•ˆ": { gen: 9600 }, "í•¨í‰": { gen: 7700 }, "ì˜ê´‘": { gen: 11800 }, "ì¥ì„±": { gen: 11100 }, "ì™„ë„": { gen: 11600 }, "ì§„ë„": { gen: 10300 }, "ë‚¨ì•…": { gen: 3700 } },
            "ë¬´ì•ˆ": { "ê´‘ì£¼": { gen: 6000, pre: 7800 }, "ëª©í¬": { gen: 3200 }, "ì—¬ìˆ˜": { gen: 19000 }, "ìˆœì²œ": { gen: 14700, pre: 18200 }, "ë‚˜ì£¼": { gen: 4100 }, "ê´‘ì–‘": { gen: 14400 }, "ë‹´ì–‘": { gen: 8900 }, "ê³¡ì„±": { gen: 11500 }, "êµ¬ë¡€": { gen: 15800 }, "ê³ í¥": { gen: 22200 }, "ë³´ì„±": { gen: 16700 }, "í™”ìˆœ": { gen: 8500 }, "ì¥í¥": { gen: 13400 }, "ê°•ì§„": { gen: 11000 }, "í•´ë‚¨": { gen: 11900 }, "ì˜ì•”": { gen: 9600 }, "í•¨í‰": { gen: 2500 }, "ì˜ê´‘": { gen: 5500 }, "ì¥ì„±": { gen: 8400 }, "ì™„ë„": { gen: 18900 }, "ì§„ë„": { gen: 11500 }, "ë‚¨ì•…": { gen: 3700 } },
            "í•¨í‰": { "ê´‘ì£¼": { gen: 4500, pre: 5800 }, "ëª©í¬": { gen: 5100 }, "ì—¬ìˆ˜": { gen: 17500 }, "ìˆœì²œ": { gen: 12900 }, "ë‚˜ì£¼": { gen: 3700 }, "ê´‘ì–‘": { gen: 12900 }, "ë‹´ì–‘": { gen: 7400 }, "ê³¡ì„±": { gen: 8800 }, "êµ¬ë¡€": { gen: 14300 }, "ê³ í¥": { gen: 20700 }, "ë³´ì„±": { gen: 15000 }, "í™”ìˆœ": { gen: 7000 }, "ì¥í¥": { gen: 15300 }, "ê°•ì§„": { gen: 11600 }, "í•´ë‚¨": { gen: 13800 }, "ì˜ì•”": { gen: 7700 }, "ë¬´ì•ˆ": { gen: 2500 }, "ì˜ê´‘": { gen: 3600 }, "ì¥ì„±": { gen: 6900 }, "ì™„ë„": { gen: 20800 }, "ì§„ë„": { gen: 13400 }, "ë‚¨ì•…": { gen: 6800 } },
            "ì˜ê´‘": { "ê´‘ì£¼": { gen: 7300, pre: 9500 }, "ëª©í¬": { gen: 8700 }, "ì—¬ìˆ˜": { gen: 20300 }, "ìˆœì²œ": { gen: 15700 }, "ë‚˜ì£¼": { gen: 7400 }, "ê´‘ì–‘": { gen: 15700 }, "ë‹´ì–‘": { gen: 10200 }, "ê³¡ì„±": { gen: 12800 }, "êµ¬ë¡€": { gen: 17100 }, "ê³ í¥": { gen: 23500 }, "ë³´ì„±": { gen: 17800 }, "í™”ìˆœ": { gen: 9800 }, "ì¥í¥": { gen: 18900 }, "ê°•ì§„": { gen: 16500 }, "í•´ë‚¨": { gen: 17400 }, "ì˜ì•”": { gen: 11800 }, "ë¬´ì•ˆ": { gen: 5500 }, "í•¨í‰": { gen: 3600 }, "ì¥ì„±": { gen: 5900 }, "ì™„ë„": { gen: 24400 }, "ì§„ë„": { gen: 17000 }, "ë‚¨ì•…": { gen: 8700 } },
            "ì¥ì„±": { "ê´‘ì£¼": { gen: 2400 }, "ëª©í¬": { gen: 9600 }, "ì—¬ìˆ˜": { gen: 10800 }, "ìˆœì²œ": { gen: 6700 }, "ë‚˜ì£¼": { gen: 10800 }, "ê´‘ì–‘": { gen: 5300 }, "ë‹´ì–‘": { gen: 7900 }, "ê³¡ì„±": { gen: 12200 }, "êµ¬ë¡€": { gen: 18600 }, "ê³ í¥": { gen: 12900 }, "ë³´ì„±": { gen: 4900 }, "í™”ìˆœ": { gen: 13900 }, "ì¥í¥": { gen: 14100 }, "ê°•ì§„": { gen: 16100 }, "í•´ë‚¨": { gen: 11100 }, "ì˜ì•”": { gen: 8400 }, "ë¬´ì•ˆ": { gen: 6900 }, "í•¨í‰": { gen: 5900 }, "ì˜ê´‘": { gen: 9700 }, "ì™„ë„": { gen: 22900 }, "ì§„ë„": { gen: 14000 }, "ë‚¨ì•…": { gen: 15500 } },
            "ì™„ë„": { "ê´‘ì£¼": { gen: 20500, pre: 24800 }, "ëª©í¬": { gen: 15700 }, "ì—¬ìˆ˜": { gen: 28200 }, "ìˆœì²œ": { gen: 23200 }, "ë‚˜ì£¼": { gen: 16600 }, "ê´‘ì–‘": { gen: 25800 }, "ë‹´ì–‘": { gen: 23400 }, "ê³¡ì„±": { gen: 23000 }, "êµ¬ë¡€": { gen: 28400 }, "ê³ í¥": { gen: 25200 }, "ë³´ì„±": { gen: 15400 }, "í™”ìˆœ": { gen: 23000 }, "ì¥í¥": { gen: 12100 }, "ê°•ì§„": { gen: 7300 }, "í•´ë‚¨": { gen: 6700, pre: 8200 }, "ì˜ì•”": { gen: 11600 }, "ë¬´ì•ˆ": { gen: 18900 }, "í•¨í‰": { gen: 20800 }, "ì˜ê´‘": { gen: 22900 }, "ì¥ì„±": { gen: 22900 }, "ì§„ë„": { gen: 14000 }, "ë‚¨ì•…": { gen: 10100 } },
            "ì§„ë„": { "ê´‘ì£¼": { gen: 15300, pre: 19900 }, "ëª©í¬": { gen: 8300, pre: 10800 }, "ì—¬ìˆ˜": { gen: 24800 }, "ìˆœì²œ": { gen: 23900 }, "ë‚˜ì£¼": { gen: 17200 }, "ê´‘ì–‘": { gen: 23400 }, "ë‹´ì–‘": { gen: 18200 }, "ê³¡ì„±": { gen: 20800 }, "êµ¬ë¡€": { gen: 11400 }, "í•´ë‚¨": { gen: 7300 }, "ì˜ì•”": { gen: 10300 }, "ë¬´ì•ˆ": { gen: 11500 }, "í•¨í‰": { gen: 13400 }, "ì˜ê´‘": { gen: 17000 }, "ì¥ì„±": { gen: 17700 }, "ì™„ë„": { gen: 14000 }, "ë‚¨ì•…": { gen: 10100 } },
            "ë‚¨ì•…": { "ê´‘ì£¼": { gen: 7200, pre: 9300 }, "ëª©í¬": { gen: 1700 }, "ì—¬ìˆ˜": { gen: 15600, pre: 20200 }, "ìˆœì²œ": { gen: 10600, pre: 13800 }, "ë‚˜ì£¼": { gen: 9000 }, "ê´‘ì–‘": { gen: 11700 }, "ë‹´ì–‘": { gen: 10100 }, "ê³¡ì„±": { gen: 12700 }, "êµ¬ë¡€": { gen: 19000 }, "ê³ í¥": { gen: 23400 }, "ë³´ì„±": { gen: 13500 }, "í™”ìˆœ": { gen: 9700 }, "ì¥í¥": { gen: 10000 }, "ê°•ì§„": { gen: 7600 }, "í•´ë‚¨": { gen: 8500 }, "ì˜ì•”": { gen: 3700 }, "ë¬´ì•ˆ": { gen: 3700 }, "í•¨í‰": { gen: 2500 }, "ì˜ê´‘": { gen: 5500 }, "ì¥ì„±": { gen: 8400 }, "ì™„ë„": { gen: 18900 }, "ì§„ë„": { gen: 11500 } } 
        };

        const ALLOWED_CITIES = Object.keys(REGION_ICONS);
        const CHOSUNG = ["ã„±","ã„²","ã„´","ã„·","ã„¸","ã„¹","ã…","ã…‚","ã…ƒ","ã……","ã…†","ã…‡","ã…ˆ","ã…‰","ã…Š","ã…‹","ã…Œ","ã…","ã…"];
        const COMPLEX_JAMO_MAP = {'ã„³':'ã„±ã……','ã„µ':'ã„´ã…ˆ','ã„¶':'ã„´ã…','ã„º':'ã„¹ã„±','ã„»':'ã„¹ã…','ã„¼':'ã„¹ã…‚','ã„½':'ã„¹ã……','ã„¾':'ã„¹ã…Œ','ã„¿':'ã„¹ã…','ã…€':'ã„¹ã…','ã…„':'ã…‚ã……'};

        const getChosungStr = (str) => { if (!str) return ""; let result = ""; for (let i = 0; i < str.length; i++) { const code = str.charCodeAt(i) - 44032; if (code > -1 && code < 11172) result += CHOSUNG[Math.floor(code / 588)]; else result += str.charAt(i); } return result; };
        const resolveComplexJamo = (str) => { let result = ""; for (let char of str) { result += COMPLEX_JAMO_MAP[char] || char; } return result; };
        const normalize = (str) => (str || '').trim().replace(/\s/g, "");
        const fmt = (num) => Number(num).toLocaleString('ko-KR');
        
        const getTagStyles = (tag) => { 
            const map = { 
                'ìê°€ìš©': 'bg-blue-50 text-blue-600 border-blue-100', 
                'ê´€ìš©ì°¨': 'bg-rose-50 text-rose-600 border-rose-100', 
                'ë‹¹ì¼': 'bg-emerald-50 text-emerald-600 border-emerald-100', 
                'ì™•ë³µ': 'bg-slate-50 text-slate-400 border-slate-100', 
                'ì—¬ê°ì„ ': 'bg-sky-50 text-sky-600 border-sky-100', 
                'ë†ì–´ì´Œë²„ìŠ¤': 'bg-amber-50 text-amber-600 border-amber-100', 
                'í¸ë„': 'bg-slate-50 text-slate-400 border-slate-100' 
            }; 
            return map[tag] || 'bg-gray-50 text-gray-600 border-gray-100'; 
        };

        const { useState, useEffect } = React;

        const AutocompleteInput = ({ value, onChange, onSelect, placeholder, label, cityList }) => {
            const [suggestions, setSuggestions] = useState([]);
            const [showSuggestions, setShowSuggestions] = useState(false);
            const [activeIndex, setActiveIndex] = useState(-1);
            useEffect(() => { const inputVal = (value || '').trim(); if (!inputVal || cityList.includes(inputVal)) { setSuggestions([]); return; } const resolved = resolveComplexJamo(inputVal); const isChosung = /^[ã„±-ã…]+$/.test(resolved); let exact = cityList.filter(city => { if (isChosung) return getChosungStr(city).includes(resolved); return city.includes(inputVal); }); setSuggestions(exact.length > 0 ? exact : []); }, [value, cityList]);
            const handleSelect = (city) => { onSelect(city); setShowSuggestions(false); setSuggestions([]); setActiveIndex(-1); };
            const handleKeyDown = (e) => { if (e.key === 'ArrowDown') { e.preventDefault(); if (suggestions.length > 0) setActiveIndex(prev => (prev < suggestions.length - 1 ? prev + 1 : 0)); } else if (e.key === 'ArrowUp') { e.preventDefault(); if (suggestions.length > 0) setActiveIndex(prev => (prev > 0 ? prev - 1 : suggestions.length - 1)); } else if (e.key === 'Enter') { if (e.nativeEvent.isComposing) return; if (activeIndex >= 0) handleSelect(suggestions[activeIndex]); else if (suggestions.length > 0) handleSelect(suggestions[0]); } };
            return (
                <div className="relative w-full group">
                    <div className="input-group">
                        <Icons.MapPin className="text-gray-300 group-focus-within:text-teal-500 transition-colors shrink-0" />
                        <div className="flex-1 min-w-0">
                            {label && <label className="block text-[10px] font-bold text-gray-400 uppercase tracking-tighter mb-0.5">{label}</label>}
                            <input type="text" className="w-full bg-transparent outline-none font-gmarket font-bold text-gray-800 text-2xl placeholder-gray-300" placeholder={placeholder} value={value || ''} onChange={e => { onChange(e.target.value); setShowSuggestions(true); }} onClick={() => { if (value) { onChange(''); onSelect(''); } }} onFocus={() => setShowSuggestions(true)} onBlur={() => setTimeout(() => setShowSuggestions(false), 200)} onKeyDown={handleKeyDown} autoComplete="off" />
                        </div>
                        <div className="w-14 flex justify-center items-center shrink-0 pt-2">{value && REGION_ICONS[value.replace(/\s/g, "")] && <span className="text-4xl icon-bounce">{REGION_ICONS[value.replace(/\s/g, "")]}</span>}</div>
                    </div>
                    {showSuggestions && suggestions.length > 0 && (
                        <div className="suggestions-box custom-scroll">
                            {suggestions.map((city, idx) => (
                                <div key={city} onMouseDown={() => handleSelect(city)} onMouseEnter={() => setActiveIndex(idx)} className={`suggestion-item ${idx === activeIndex ? 'active' : ''}`}>
                                    <span className="text-lg font-bold">{city}</span><span className="text-2xl">{REGION_ICONS[city.replace(/\s/g, "")]}</span>
                                </div>
                            ))}
                        </div>
                    )}
                </div>
            );
        };

        const Toggle = ({ checked, onChange }) => (
            <button onClick={() => onChange(!checked)} className={`toggle-switch ${checked ? 'toggle-active' : 'toggle-inactive'}`}>
                <span className={`toggle-knob ${checked ? 'knob-active' : ''}`} />
            </button>
        );

        const App = () => {
            const [origin, setOrigin] = useState('');
            const [destination, setDestination] = useState('');
            const [result, setResult] = useState(null);
            const [modalState, setModalState] = useState({ type: null, data: [] });
            const [showDetail, setShowDetail] = useState(false);
            const [shipFare, setShipFare] = useState(0); 
            const [manualMainTransport, setManualMainTransport] = useState(null); 
            const [intraCityOpen, setIntraCityOpen] = useState(false);
            const [intraDeductions, setIntraDeductions] = useState({ shortTime: false, govVehicle: false });
            const [activeModal, setActiveModal] = useState(null); 
            const [deductions, setDeductions] = useState({ gov_vehicle: false, meal_1: false, meal_2: false, meal_3: false, meal_half: false, transport_proof: false, transport_gov_vehicle: false, transport_passenger: false });

            const calculateDetailedCost = () => { if (!result) return { total: 0 }; let daily = deductions.gov_vehicle ? 12500 : 25000; let meal = deductions.meal_3 ? 0 : deductions.meal_1 ? 16670 : deductions.meal_2 ? 8330 : deductions.meal_half ? 12500 : 25000; let transport = (deductions.transport_proof || deductions.transport_gov_vehicle || deductions.transport_passenger) ? 0 : (result.type === 'internal' ? (manualMainTransport || 0) : 0); return { daily, meal, transport, total: daily + meal + transport + (shipFare || 0) }; };

            const performCalculation = (o = origin, d = destination, isForce = false) => {
                const from = normalize(o); const to = normalize(d);
                setDeductions({ gov_vehicle: false, meal_1: false, meal_2: false, meal_3: false, meal_half: false, transport_proof: false, transport_gov_vehicle: false, transport_passenger: false });
                setShipFare(0); setManualMainTransport(null); setShowDetail(false);
                const fromNormalized = o.replace(/\s/g, ""); const toNormalized = d.replace(/\s/g, "");
                if (!isForce) { if (POPUP_REGIONS[fromNormalized] && !modalState.type) { setModalState({ type: 'origin', data: POPUP_REGIONS[fromNormalized] }); return; } if (POPUP_REGIONS[toNormalized] && !modalState.type) { setModalState({ type: 'destination', data: POPUP_REGIONS[toNormalized] }); return; } }
                if (!from || !to) return;
                for (const group of SAME_AREA_GROUPS) { if (group.has(from) && group.has(to)) { setIntraCityOpen(true); return; } }
                const fromIsland = ISLAND_DB[from]; const toIsland = ISLAND_DB[to];
                let searchFrom = from; let searchTo = to; let surcharge = 0; let shipSurcharge = 0; let islandConfig = null; let viaPoint = null;
                if (fromIsland) { searchFrom = fromIsland.hub; shipSurcharge += (fromIsland.shipCost || 0); islandConfig = fromIsland; viaPoint = fromIsland.via || fromIsland.hub; }
                if (toIsland) { searchTo = toIsland.hub; shipSurcharge += (toIsland.shipCost || 0); islandConfig = toIsland; viaPoint = toIsland.via || toIsland.hub; }
                
                // [êµì •] ë†ì–´ì´Œë²„ìŠ¤ ìš”ê¸ˆ í•©ì‚° ë¡œì§ ê°•í™”: ì„¬ ì§€ì—­ì˜ costë¥¼ í•©ì‚°í•˜ì—¬ ìš”ê¸ˆ ì •ë³´ í•˜ë‹¨ê³¼ ì—¬ë¹„ê³„ì‚°ì— ì „ë‹¬
                surcharge = (fromIsland?.cost || 0) + (toIsland?.cost || 0);

                const baseData = INITIAL_DATA[searchFrom]?.[searchTo] || INITIAL_DATA[searchTo]?.[searchFrom];
                if (baseData || (searchFrom === searchTo)) { 
                    const finalGen = (baseData?.gen || 0) + surcharge; 
                    const finalPre = baseData?.pre ? baseData.pre + surcharge : null; 
                    const finalCost = finalPre ? finalPre : finalGen; 
                    setShipFare(shipSurcharge * 2); 
                    setManualMainTransport(finalCost * 2); 
                    setResult({ type: 'internal', cost: finalCost, baseBusCost: baseData?.pre || baseData?.gen || 0, surcharge, shipCost: shipSurcharge, isShipOnlyRoute: islandConfig?.type === 'ship', viaPoint }); 
                } else setResult({ type: 'external' });
            };

            const detailCosts = calculateDetailedCost();
            const routeTags = (() => { const tags = []; if (!result || result.type !== 'internal') return tags; tags.push(deductions.gov_vehicle ? 'ê´€ìš©ì°¨' : 'ìê°€ìš©', "ë‹¹ì¼", "ì™•ë³µ"); const isWandoConnected = (l) => ISLAND_DB[l]?.hub === 'ì™„ë„' && ISLAND_DB[l]?.type === 'connected'; 
                if (((ISLAND_DB[origin]?.type === 'connected' && !isWandoConnected(origin)) || (ISLAND_DB[destination]?.type === 'connected' && !isWandoConnected(destination))) || (result.surcharge > 0)) {
                    tags.push("ë†ì–´ì´Œë²„ìŠ¤");
                }
                if (result.viaPoint) tags.push(`${result.viaPoint} ê²½ìœ `); if (result.shipCost > 0 || result.isShipOnlyRoute) tags.push("ì—¬ê°ì„ "); return tags; 
            })();

            const getModalContent = (key) => {
                const destTag = <span className="inline-block px-1.5 py-0.5 mx-1 bg-slate-100 text-slate-600 rounded border border-slate-200 font-bold align-top relative -top-0.5 text-[10px] leading-none">{destination}</span>;
                if (key === 'daily') { return { title: "ì¼ë¹„", desc: <span>ì¶œì¥ì§€{destTag} ë‚´ì—ì„œ ì†Œìš”ë˜ëŠ” í˜„ì§€ êµí†µë¹„, í†µì‹ ë¹„, ìŒë£Œë¹„ ë“± ì—¬í–‰ ì¤‘ ë°œìƒí•˜ëŠ” ê°ì¢… ì†Œì•¡ì˜ ê²½ë¹„ë¥¼ ì¶©ë‹¹í•˜ê¸° ìœ„í•œ ê²½ë¹„</span>, items: [ { id: 'gov_vehicle', label: "ê³µìš©ì°¨ëŸ‰Â·ì„ì°¨ì°¨ëŸ‰(ì „ì„¸ë²„ìŠ¤ ë“±)ì„ ì´ìš©", subLabel: "" } ] }; }
                if (key === 'meal') { return { title: "ì‹ë¹„", desc: "ì—¬í–‰(ì¶œì¥) ì¤‘ ì‹ì‚¬ì— ì†Œìš”ë˜ëŠ” ë¹„ìš©. ë°¥ì„ ë¨¹ì„ í•„ìš”ê°€ ì—†ê±°ë‚˜ ë‹¤ë¥¸ ëˆìœ¼ë¡œ ë°¥ì„ ë¨¹ì—ˆì„ ë•Œ ê°ì•¡.", items: [ { id: 'meal_1', label: "1ì‹ ê°ì•¡", subLabel: "" }, { id: 'meal_2', label: "2ì‹ ê°ì•¡", subLabel: "" }, { id: 'meal_3', label: "ì „ì•¡ ê°ì•¡", subLabel: "" }, { id: 'meal_half', label: "Â½ ê°ì•¡", subLabel: "" } ] }; }
                if (key === 'transport') { return { title: "êµí†µë¹„", desc: <span>ê·¼ë¬´ì§€ì—ì„œ ì¶œì¥ ëª©ì ì§€{destTag}ë¡œ ì´ë™í•˜ê¸° ìœ„í•´ ì†Œìš”ë˜ëŠ” êµí†µìˆ˜ë‹¨ì˜ ë¹„ìš©</span>, items: [ { id: 'transport_proof', label: "ì¦ê±°ì„œë¥˜ ë¯¸ì œì¶œÂ·ë¶€ì ì •" }, { id: 'transport_gov_vehicle', label: "ê³µìš©/ì„ì°¨ì°¨ëŸ‰ ì´ìš©" }, { id: 'transport_passenger', label: "ë™ë£Œ ì°¨ëŸ‰ ë™ìŠ¹", subLabel: "ë™ìŠ¹ì êµí†µë¹„ ë¯¸ì§€ê¸‰" } ] }; }
            };

            const getMealDeductionLabel = () => { if (deductions.meal_1) return "(-8,330)"; if (deductions.meal_2) return "(-16,670)"; if (deductions.meal_3) return "(-25,000)"; if (deductions.meal_half) return "(-12,500)"; return ""; };

            return (
                <div className="main-wrapper font-pretendard">
                    <header className="header-teal">
                        <div className="flex flex-col"><h1 className="font-gmarket font-black text-3xl text-[#00BFA5] tracking-tighter">yeobi-easy</h1><p className="text-[12px] font-bold text-gray-400 mt-0.5">by JHN Â· for JNE Fellows</p></div>
                        <div className="mode-switch-container" onClick={() => setIntraCityOpen(!intraCityOpen)}><div className={`mode-switch-slider ${intraCityOpen ? 'intra' : 'extra'}`}></div><div className={`mode-text ${!intraCityOpen ? 'active' : 'inactive'}`}>ê´€ì™¸</div><div className={`mode-text ${intraCityOpen ? 'active' : 'inactive'}`}>ê´€ë‚´</div></div>
                    </header>
                    <main className="flex-1 p-6 space-y-6 overflow-y-auto">
                        <div className="space-y-6">
                            <AutocompleteInput label="ì¶œë°œì§€" placeholder="ì˜ˆ: ê´‘ì£¼, ã„±ã…ˆ" value={origin} onChange={setOrigin} onSelect={(city) => { setOrigin(city); performCalculation(city, destination); }} cityList={ALLOWED_CITIES} />
                            <AutocompleteInput label="ë„ì°©ì§€" placeholder="ì˜ˆ: í•´ë‚¨, ã…ã„´" value={destination} onChange={setDestination} onSelect={(city) => { setDestination(city); performCalculation(origin, city); }} cityList={ALLOWED_CITIES} />
                            <button onClick={() => performCalculation()} className="w-full h-[76px] bg-[#00BFA5] text-white rounded-2xl text-2xl font-bold flex items-center justify-center gap-3 mt-6 hover:opacity-90 active:scale-95 transition-all shadow-sm">
                                <Icons.Search size={30} /> ì¡°íšŒí•˜ê¸°
                            </button>
                        </div>

                        {result && (
                            <div className="result-card animate-slide-up pb-6 bg-white mt-6">
                                <div className="text-center mb-6">
                                    <div className="flex justify-between items-center h-12 px-2"><div className="flex items-center"><span className="font-bold text-gray-800 text-xl">ìš”ê¸ˆ</span><span className={`tag-side ${getTagStyles('í¸ë„')}`}>í¸ë„</span></div><span className="text-3xl font-extrabold text-[#00BFA5] font-suit">{fmt(result.type === 'internal' ? (result.surcharge > 0 ? result.baseBusCost : result.cost) : 0)}ì›</span></div>
                                    {result.type === 'internal' && result.surcharge > 0 && (<div className="flex justify-between items-center h-12 px-2"><div className="flex items-center"><span className="font-bold text-emerald-500 text-lg">ë†ì–´ì´Œë²„ìŠ¤</span><span className={`tag-side ${getTagStyles('í¸ë„')}`}>í¸ë„</span></div><span className="text-xl font-bold text-emerald-500 font-suit">{fmt(result.surcharge)}ì›</span></div>)}
                                    {result.type === 'internal' && result.shipCost > 0 && (<div className="flex justify-between items-center h-10 px-2 mt-1"><div className="flex items-center"><span className="font-bold text-sky-500 text-lg">ì—¬ê°ì„ </span><span className={`tag-side ${getTagStyles('í¸ë„')}`}>í¸ë„</span></div><span className="text-xl font-bold text-sky-500 font-suit">{fmt(result.shipCost)}ì›</span></div>)}
                                    <div className="pb-4 pt-4 flex flex-wrap justify-center gap-1.5 mb-2">
                                        {routeTags.map((tag, i) => (<span key={i} className={`tag-badge px-2.5 py-1 text-[14px] ${getTagStyles(tag)}`}>{tag}</span>))}
                                    </div>
                                    <button onClick={() => setShowDetail(!showDetail)} className={`w-full mt-6 h-[72px] rounded-2xl font-bold text-2xl flex items-center justify-center gap-3 shadow-sm transition-all text-white bg-[#00BFA5] ${showDetail ? 'opacity-70' : 'animate-pulse-spread'}`}>
                                        <Icons.Calculator size={30} /><span>ì—¬ë¹„ê³„ì‚°</span><Icons.ChevronDown className={`transition-transform duration-300 ${showDetail ? 'rotate-180' : ''}`} size={26} />
                                    </button>
                                </div>
                                <div className={`detail-drawer ${showDetail ? 'open' : ''}`}>
                                    <div className="p-4 pt-4 space-y-6 border-t border-gray-100">
                                        <div className="relative flex items-center justify-between h-12">
                                            <span className="font-bold text-gray-600 text-xl w-24">ì¼ë¹„</span>
                                            <button onClick={()=>setActiveModal('daily')} className={`deduct-btn ${deductions.gov_vehicle ? 'active':''}`}>
                                                <span className={!deductions.gov_vehicle ? "animate-twinkle-text" : ""}>ê°ì•¡</span>
                                            </button>
                                            <div className="flex flex-col items-end flex-1"><span className="text-xl font-bold text-gray-900 font-suit">{fmt(detailCosts.daily)}ì›</span>{deductions.gov_vehicle && <span className="text-[11px] text-rose-500 font-bold leading-none mt-1">(-12,500)</span>}</div>
                                        </div>
                                        <div className="relative flex items-center justify-between h-12">
                                            <span className="font-bold text-gray-600 text-xl w-24">ì‹ë¹„</span>
                                            <button onClick={()=>setActiveModal('meal')} className={`deduct-btn ${(deductions.meal_1||deductions.meal_2||deductions.meal_3||deductions.meal_half) ? 'active':''}`}>
                                                <span className={!(deductions.meal_1||deductions.meal_2||deductions.meal_3||deductions.meal_half) ? "animate-twinkle-text" : ""}>ê°ì•¡</span>
                                            </button>
                                            <div className="flex flex-col items-end flex-1"><span className="text-xl font-bold text-gray-900 font-suit">{fmt(detailCosts.meal)}ì›</span><span className="text-[11px] text-rose-500 font-bold leading-none mt-1">{getMealDeductionLabel()}</span></div>
                                        </div>
                                        <div className="pt-4 border-t border-dashed border-gray-200">
                                            <div className="relative flex items-center justify-between h-12">
                                                <div className="flex items-center"><span className="font-bold text-gray-600 text-xl">êµí†µë¹„</span><span className={`tag-side ${getTagStyles('ì™•ë³µ')}`}>ì™•ë³µ</span></div>
                                                <button onClick={()=>setActiveModal('transport')} className={`deduct-btn ${deductions.transport_proof || deductions.transport_gov_vehicle || deductions.transport_passenger ? 'active':''}`}>
                                                    <span className={!(deductions.transport_proof || deductions.transport_gov_vehicle || deductions.transport_passenger) ? "animate-twinkle-text" : ""}>ê°ì•¡</span>
                                                </button>
                                                <div className="text-right flex-1">
                                                    {!(deductions.transport_proof || deductions.transport_gov_vehicle || deductions.transport_passenger) ? (
                                                        <div className="flex items-center justify-end gap-1">
                                                            <input 
                                                                type="tel" 
                                                                value={manualMainTransport === null || manualMainTransport === 0 ? '' : fmt(manualMainTransport)} 
                                                                onFocus={(e) => e.target.select()}
                                                                onChange={(e) => { 
                                                                    const val = e.target.value.replace(/,/g, ''); 
                                                                    setManualMainTransport(val === '' ? null : Number(val)); 
                                                                }}
                                                                className="ship-fare-input" 
                                                                placeholder="0" 
                                                            />
                                                            <span className="text-xl font-bold text-gray-900">ì›</span>
                                                        </div>
                                                    ) : <span className="text-xl font-bold text-gray-400">0ì›</span>}
                                                </div>
                                            </div>
                                            {(shipFare > 0 || result.isShipOnlyRoute || result.shipCost > 0) && (
                                                <div className="relative flex items-center justify-between h-12 mt-2">
                                                    <span className="font-bold text-gray-600 text-xl">ê¸°íƒ€êµí†µë¹„</span>
                                                    <div className="text-right flex-1">
                                                        <div className="flex items-center justify-end gap-1">
                                                            <input 
                                                                type="tel" 
                                                                value={shipFare === 0 ? '' : fmt(shipFare)} 
                                                                onFocus={(e) => e.target.select()}
                                                                onChange={(e) => { 
                                                                    const val = e.target.value.replace(/,/g, ''); 
                                                                    setShipFare(val === '' ? 0 : Number(val)); 
                                                                }}
                                                                className="ship-fare-input" 
                                                                placeholder="0" 
                                                            />
                                                            <span className="text-xl font-bold text-gray-900">ì›</span>
                                                        </div>
                                                    </div>
                                                </div>
                                            )}
                                        </div>
                                        <div className="pt-4 border-t-2 border-gray-100 flex justify-between items-center"><span className="font-bold text-gray-900 text-xl">í•©ê³„</span><span className="text-3xl font-extrabold text-[#00BFA5] font-suit">{fmt(detailCosts.total)}<span className="text-xl ml-1">ì›</span></span></div>
                                    </div>
                                </div>
                            </div>
                        )}
                        <div className="mt-4">
                            <a href="https://padlet.com/jbyhee/hyonu-s-padlet-4m26339lwedx23dc" target="_blank" rel="noopener noreferrer" className="w-full h-[76px] bg-[#E0F2F1] border border-[#B2DFDB] text-[#00695C] rounded-2xl flex flex-col items-center justify-center no-underline hover:opacity-90 active:scale-95 transition-all shadow-sm">
                                <div className="flex items-center gap-2">
                                    <Icons.Send size={22} />
                                    <span className="text-[17px] font-bold">ë¬¸ì˜ ë° ì˜ê²¬ ë‚¨ê¸°ê¸°</span>
                                </div>
                                <span className="text-[11px] font-medium opacity-70 mt-1">Crafted with Passion by ì „í˜„ìš°@ìš°ìˆ˜ì˜ì´ˆë“±í•™êµ</span>
                            </a>
                        </div>
                    </main>

                    {intraCityOpen && (
                        <div className="fixed inset-0 z-[110] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in" onClick={() => setIntraCityOpen(false)}>
                            <div className="bg-white w-full max-w-sm rounded-2xl shadow-2xl overflow-hidden animate-slide-up" onClick={e => e.stopPropagation()}>
                                <div className="p-6">
                                    <div className="flex justify-between items-center mb-6"><h3 className="font-bold text-xl text-gray-900">ê´€ë‚´ ì—¬ë¹„</h3><button onClick={() => setIntraCityOpen(false)} className="text-gray-400"><Icons.X size={22} /></button></div>
                                    <div className="mb-6 p-4 bg-gray-50 rounded-xl border border-gray-100 text-sm font-medium text-gray-600 leading-relaxed break-keep">ê·¼ë¬´ì§€ ë‚´ì˜ ì¶œì¥ì€ ë³„ë„ì˜ ì˜ìˆ˜ì¦ ì¦ë¹™ ì—†ì´<br/>ì •ì•¡ ì§€ê¸‰ë©ë‹ˆë‹¤.</div>
                                    <div className="space-y-4 border-t border-b border-gray-100 py-6">
                                        <div className="flex justify-between items-center"><span className="text-base font-bold text-gray-700">4ì‹œê°„ ë¯¸ë§Œ</span><Toggle checked={intraDeductions.shortTime} onChange={(val) => setIntraDeductions(p => ({...p, shortTime: val}))} /></div>
                                        <div className="flex justify-between items-center"><span className="text-base font-bold text-gray-700">ê´€ìš©ì°¨ëŸ‰ ì´ìš©</span><Toggle checked={intraDeductions.govVehicle} onChange={(val) => setIntraDeductions(p => ({...p, govVehicle: val}))} /></div>
                                    </div>
                                    <div className="mt-8 flex justify-between items-center"><span className="text-xl font-bold text-gray-900">ì§€ê¸‰ì•¡</span><span className="text-2xl font-black text-blue-600 font-suit">{fmt(20000 - (intraDeductions.shortTime ? 10000 : 0) - (intraDeductions.govVehicle ? 10000 : 0))}ì›</span></div>
                                    <button onClick={() => setIntraCityOpen(false)} className="bg-[#00BFA5] text-white w-full mt-10 h-14 rounded-xl font-bold text-lg shadow-sm">ë‹«ê¸°</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {activeModal && (() => {
                        const content = getModalContent(activeModal);
                        return (
                            <div className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in" onClick={() => setActiveModal(null)}>
                                <div className="bg-white w-full max-sm rounded-3xl shadow-2xl animate-in zoom-in-95 overflow-hidden" onClick={e => e.stopPropagation()}>
                                    <div className="p-7 max-h-[85vh] overflow-y-auto custom-scroll">
                                        <div className="flex justify-between items-center mb-4"><h3 className="text-xl font-bold text-gray-900">{content.title}</h3><button onClick={()=>setActiveModal(null)}><Icons.X size={20} className="text-gray-400"/></button></div>
                                        <p className="text-sm text-gray-600 font-medium leading-relaxed mb-4 break-keep font-pretendard">{content.desc}</p>
                                        {activeModal === 'meal' && (
                                            <div className="mb-6 space-y-4">
                                                <div className="p-4 bg-amber-50 rounded-2xl border border-amber-100">
                                                    <p className="text-[13px] font-bold text-amber-800 mb-2">ğŸ’¡ ê°ì•¡ ì‚¬ìœ </p>
                                                    <ul className="text-[12px] text-amber-700 space-y-2 list-disc pl-4 leading-snug break-keep">
                                                        <li>ì£¼ìµœ ì¸¡Â·ì´ˆì²­ê¸°ê´€ì—ì„œ ì‹ì‚¬ë¥¼ ì œê³µí•œ ê²½ìš°</li>
                                                        <li>ì—…ë¬´ì¶”ì§„ë¹„(ë²•ì¸ì¹´ë“œ)ë¡œ ì‹ì‚¬ë¥¼ í•´ê²°í•œ ê²½ìš°</li>
                                                        <li>ê´€ë‚´Â·ê´€ì™¸ì¶œì¥ ì¤‘ë³µëì„ ë•Œ(ê´€ë‚´ì¶œì¥ì—ë„ ìš°ì„  ì‹ë¹„ê°€ í¬í•¨ë¨. í˜¹ ê´€ë‚´ì¶œì¥ì„ ë¶€ì§€ê¸‰ìœ¼ë¡œ í•´ë„, í†µìƒì ì¸ ì‹ì‚¬ì‹œê°„ì— ë”°ë¼ ê°ì•¡, ì¼ê´€ì  ê¸°ì¤€ ì¤‘ìš”)</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        )}
                                        {activeModal === 'transport' && (
                                            <div className="mb-6 space-y-4">
                                                <div className="p-4 bg-blue-50 rounded-2xl border border-blue-100">
                                                    <p className="text-[13px] font-bold text-blue-800 mb-2">ğŸ“„ ì‹¤ë¹„ ì •ì‚° ë° ì¦ê±°ì„œë¥˜ ì•ˆë‚´</p>
                                                    <ul className="text-[12px] text-blue-700 space-y-2.5 list-disc pl-4 leading-snug break-keep">
                                                        <li><strong>ì •ì•¡ ì§€ê¸‰ë˜ëŠ” ì¼ë¹„Â·ì‹ë¹„ì™€ ë‹¬ë¦¬ ì‹¤ë¹„ ì •ì‚° ì›ì¹™</strong></li>
                                                        <li><strong>ê²°ì œë‚´ì—­ì´ í™•ì¸ë˜ëŠ” ì¦ê±°ì„œë¥˜ í•„ìˆ˜</strong></li>
                                                        <li><strong>ì¦ê±°ì„œë¥˜ì˜ ì˜ˆì‹œ:</strong> ì¶œì¥ì§€ì˜ ì£¼ìœ ì˜ìˆ˜ì¦, í†¨ê²Œì´íŠ¸ ì˜ìˆ˜ì¦(í•˜ì´íŒ¨ìŠ¤) ë“± ì°¨ëŸ‰ ì´ë™ ì‚¬ì‹¤ ë° ë¹„ìš© ë°œìƒì„ ì¦ëª…í•˜ëŠ” ì¦ë¹™</li>
                                                    </ul>
                                                </div>
                                            </div>
                                        )}
                                        <div className="space-y-3">{content.items.map(item => (<div key={item.id} className="flex justify-between items-center py-4 border-t border-gray-100"><div><span className="block text-[15px] font-bold text-gray-700 leading-snug">{item.label}</span>{item.subLabel && <span className="text-[11px] text-gray-400 font-bold mt-1 block">{item.subLabel}</span>}</div><Toggle checked={deductions[item.id]} onChange={() => setDeductions(prev => { 
                                            const newState = { ...prev }; 
                                            if (['meal_1','meal_2','meal_3','meal_half'].includes(item.id)) { if(!prev[item.id]) ['meal_1','meal_2','meal_3','meal_half'].forEach(k=>newState[k]=false); } 
                                            newState[item.id] = !prev[item.id]; 
                                            if (item.id === 'gov_vehicle') { newState['transport_gov_vehicle'] = newState[item.id]; }
                                            if (item.id === 'transport_gov_vehicle') { newState['gov_vehicle'] = newState[item.id]; }
                                            return newState; 
                                        })} /></div>))}</div>
                                        <button onClick={()=>setActiveModal(null)} className="bg-[#00BFA5] text-white w-full mt-8 h-12 rounded-xl font-bold text-lg shadow-sm">í™•ì¸</button>
                                    </div>
                                </div>
                            </div>
                        );
                    })()}

                    {modalState.type && (
                        <div className="fixed inset-0 z-[120] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm animate-in fade-in" onClick={() => { setModalState({ type: null, data: [] }); setTimeout(() => performCalculation(origin, destination, true), 0); }}>
                            <div className="bg-white rounded-[32px] w-full max-w-sm shadow-2xl overflow-hidden animate-in zoom-in-95" onClick={e => e.stopPropagation()}>
                                <div className="bg-[#00BFA5] p-5 text-white flex justify-between items-center font-bold text-lg font-suit">ì„¸ë¶€ ì§€ì—­ ì„ íƒ<button onClick={() => { setModalState({ type: null, data: [] }); setTimeout(() => performCalculation(origin, destination, true), 0); }}><Icons.X size={20} /></button></div>
                                <div className="p-5 max-h-[60vh] overflow-y-auto custom-scroll">
                                    <div className="grid grid-cols-3 gap-2">
                                        {modalState.data.map((name) => (
                                            <button key={name} onClick={() => { if (modalState.type === 'origin') setOrigin(name); else setDestination(name); setModalState({ type: null, data: [] }); setTimeout(() => performCalculation(modalState.type === 'origin' ? name : origin, modalState.type === 'destination' ? name : destination, true), 0); }} className="flex flex-col items-center justify-center gap-1 px-1 py-3 rounded-2xl bg-gray-50 border border-gray-100 transition-all hover:bg-teal-50 active:scale-95 outline-none shadow-sm"><span className="text-3xl">{REGION_ICONS[name.replace(/\s/g, "")]}</span><span className="text-[13px] font-bold text-gray-700 text-center font-pretendard">{name}</span></button>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>